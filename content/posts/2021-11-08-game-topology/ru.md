---
title = "Топология игры"
tags = [ "the-tale", "gamedev", "game-designe", "theory", "interesting"]
published_at = "2021-11-08T12:00:00+00:00"
description = "Подходы к достижению вариативности игрового процесса через проектирование пространства и правил взаимодействия сущностей в нём."
seo_image = "images/game-topology-cover.png"
---

/// brigid-images
src = "images/game-topology-cover.png"
caption = "Оптимальная стратегия за крестики в крестиках и ноликах. [Изображение взято из википедии](https://en.wikipedia.org/wiki/Tic-tac-toe)."
///

Или почему в [Сказке](https://the-tale.org/) игроки не могут создавать города самостоятельно. Хотя могут прокладывать дороги и менять ландшафт.

Заголовок звучит заумно, но суть проста: интересность игры зависит от вариативности геймплея, которая определяется связями между элементами игры.

<!-- more -->

Например:

- Интересность шахмат возникает из-за огромного количества вариантов расположения фигур на доске. Каждый вариант порождает уникальное сочетание ограничений, которое и делает ходы интересными.
- Интересность карточных игр, в том числе пасьянсов, определяется взаимным расположением карт в раскладе и на игровом поле, и разрешёнными операциями над ними.
- Интерес компьютерных стратегий во многом зависит от карты и того, как игроки строят на ней города/здания.
- Даже интерес шутера заключается в том, что необходимо предугадывать действия противников исходя из знаний карты и правил игры.

Можно обратить внимание, что каждая игра определяет некоторое пространство: шахматную доску, «стол», сложную стратегическую карту; и сущности, которые могут в этом пространстве действовать: фигуры, карты, юниты, здания, города.

Сложность пространства может быть разная. Например:

- В шахматах — клеточная доска 8x8.
- В 6-ой Цивилизации — гексагональное поле с огромным количеством элементов.
- В картах — группы карт: колода, несколько рук, прикуп, сброс, etc.

Одна из главных задач дизайна игры: подобрать свойства пространства и правила взаимодействия сущностей в нём, чтобы получить геймплей нужной вариабельности.

Если ошибиться, то игровая сессия будет:

- Либо сходиться к малому набору шаблонных ситуаций, что быстро убьёт интерес к игре.
- Либо зависеть от чрезмерно большого количества факторов, которые игрок не сможет держать в голове. Это приведёт к иллюзии полной случайности игрового процесса и тоже убьёт интерес.

Идеальный пример первого случая — крестики-нолики.

С примером для второго случая сложнее — такие игры долго не живут. Часто жалобы на подобный геймплей можно видеть в AA и инди [4X играх](https://en.wikipedia.org/wiki/4X), авторы которых в погоне за «крутизной» реализуют чрезмерное количество слабых механик.

## Ключевая дилемма

Пространство и правила можно проектировать по-разному. Но, как обычно, проще делать крайние случаи:

- Простое пространство + «сложные» правила взаимодействия сущностей.
- Сложное пространство + «простые» правила взаимодействия сущностей.

«Сложные» и «простые» взяты в кавычки, так как под сложностью в данном случая я понимаю не только сложность восприятия правил, но и сложность их проектирования. Также будем помнить, что сложность — понятие относительное.

Например, у шахматных фигур очень простые для восприятия игроком правила перемещения и боя. Но, с точки зрения проектирования, эти правила сложны. Игра эволюционировала тысячи лет и создать её аналог пока ни у кого не получилось.

В шахматах, за счёт проработанных правил взаимодействия фигур, можно использовать простое игровое поле.

В то же время, у Цивилизации сложная карта, но однотипные правила перемещения и боя юнитов.

Утрируя, в шахматах вариативность достигается взаимодействием фигур друг с другом, а в цивилизации — взаимодействием фигур с картой (игровым пространством).

Оба варианта имеют недостатки.

Шахматный вариант требует тонкой настройки взаимодействия сущностей. Без неё партии будут сходиться к небольшому количеству оптимальных ситуаций. Как в тех же крестиках-ноликах.

Вариант цивилизации менее требователен к настройке взаимодействия сущностей, но делает повторные игры на одной карте менее интересными, так как игроки находят оптимальные стратегии.  Это особенно заметно в киберспорте, где, чтобы обеспечить равные условия, требуется не только баланс юнитов, но и баланс карт.

## Борьба за вариативность

Противостоять «оптимальным» игровым ситуациям можно несколькими путями:

- Вводить конфликт интересов.
- Провоцировать ошибки игроков.
- Ограничивать возможность исправления ошибок.
- Добавлять новых игровых агентов.

Каждый способ по-разному показывает себя в разных жанрах.

Например, для обеспечения разнообразия в RTS и TBS скорее всего потребуются разные подходы. Аналогично для сессионных игр и игр с перманентным игровым процессом/миром (тех же ММО).

### Конфликт интересов

В игре всегда есть минимум один активный агент — игрок. Может быть несколько игроков, кроме них могут присутствовать разного рода ИИ.

Каждый агент имеет собственное представление об идеальной игровой ситуации.

Например, в шахматах для игрока белыми идеальная ситуация — мат чёрным. Для игрока чёрными — мат белым.

Игра будет по-разному себя вести, в зависимости от того, на сколько отличаются оптимумы агентов.

Если оптимумы всех агентов совпадают, то игровая ситуация будет неизменно стремиться к оптимальной, уменьшая вариативность.

Если оптимумы агентов не совпадают, а лучше — противоречат друг другу, то действия каждого агента будут разрушать достижения других, увеличивая разнообразие игровых ситуаций.

Например. Если предположить, что в шахматах оптимальные ситуации для игроков совпадают — один хочет выиграть, другой — проиграть, то всё многообразие шахмат выродится в единственную строгую последовательность ходов, которая ведёт к [дурацкому мату](https://ru.wikipedia.org/wiki/%D0%94%D1%83%D1%80%D0%B0%D1%86%D0%BA%D0%B8%D0%B9_%D0%BC%D0%B0%D1%82).

### Провокация ошибок

Если игровая ситуация сходится к оптимуму при идеальных действиях агентов, можно попробовать затруднить проведение таких действий — провоцировать ошибки.

Утрируя, делать это можно несколькими способами:

- Усложнять [модель игры]{post:life-and-work-with-models}, которую надо держать в голове.
- Увеличивать требуемую скорость принятия решений.
- Увеличивать требования к аккуратности действий.
- Добавлять случайность к результатам действий.
- Добавлять неизвестность. См. [теорию игр](https://ru.wikipedia.org/wiki/%D0%A2%D0%B5%D0%BE%D1%80%D0%B8%D1%8F_%D0%B8%D0%B3%D1%80) и [игры с неполной информацией](https://ru.wikipedia.org/wiki/%D0%98%D0%B3%D1%80%D0%B0_%D1%81_%D0%BD%D0%B5%D0%BF%D0%BE%D0%BB%D0%BD%D0%BE%D0%B9_%D0%B8%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D0%B5%D0%B9).

Про сложность модели игры можно готовить отдельное эссе — вариантов множество.

Мой любимый — управление [локальностью взаимодействия](https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%B8%D0%BD%D1%86%D0%B8%D0%BF_%D0%BB%D0%BE%D0%BA%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D0%B8) сущностей. Для примера посмотрим на шахматы. В них есть фигуры, дальность хода которых не ограничена: ферзь, ладья, офицер. Поэтому, от размера доски будет зависеть сложность оценки игровой ситуации. Чем больше доска — тем на большее количество клеток влияют эти фигуры и тем сложнее за этим влиянием следить. В то же время конь, пешка, король влияют только на клетки вокруг себя, что позволяет рассматривать ситуации с ними локально.

Сокрытие информации от игроков естественным образом увеличивает вероятность ошибки. Классический вариант — [туман войны](https://ru.wikipedia.org/wiki/%D0%A2%D1%83%D0%BC%D0%B0%D0%BD_%D0%B2%D0%BE%D0%B9%D0%BD%D1%8B).

Для пошаговых и размеренных игр, обычно, лучше подходит усложнение модели и добавление случайности. Например, в D&D вы можете не только забыть о какой-нибудь важной механике, но и просто выкинуть 1 на кубике. Каким бы идеальным ни был ваш план, критический промах легко пустит всё под откос.

Для игр реального времени чаще модифицируют требования к скорости и точности. Например, в StarCraft важны обе составляющие игры: стратегия и микроконтроль. Игрок, который хорош в стратегии, может слить все достижения, проиграв в микроконтроле.

### Ограничение исправления ошибок

Этот подход тесно связан с предыдущим, но я всё-таки вынесу его в отдельный пункт.

Если игрок всё-таки совершил ошибку, будущие игровые ситуации будут сильно зависеть от возможности её исправить. Если исправление дёшево — игрок может вернуть игру на оптимальную для себя траекторию. Если дорого — ему потребуется пересмотреть стратегию и, возможно, изменить представление об оптимальной ситуации.

Например.

В RTS, потеря армии, часто, — исправимая ошибка. Если игрок подготовился, он может восстановить армию, а затем вернуть утраченные на карте позиции.

В Цивилизации, создание города в невыгодной позиции — ошибка, которую сложно исправить. В этом случае игроку придётся пересмотреть стратегию с учётом новых обстоятельств.

Исправляемые ошибки делают геймплей похожим на перетягивание каната, что хорошо подходит для соревновательных игр.

Неисправляемые — заставляют глубже пересматривать стратегию, что, на мой взгляд, удобнее для PvE игр и игр с размеренным геймплеем.

### Добавление новых агентов

Очень интересный подход. В геймплей добавляются новые агенты, обычно ИИ, действия которых увеличивают вариативность за счёт наличия несовпадающих представлений об оптимальной ситуации.

При этом возможности агентов могут сильно отличаться от возможностей игроков.

Один из его вариантов таких агентов известен в геймдеве как AI Director. Он следит за ходом партии и подстраивает её для увеличения интереса игроков.

Используется в таких играх как [Left 4 Dead](https://left4dead.fandom.com/wiki/The_Director) и [RimWorld](https://rimworldwiki.com/wiki/AI_Storytellers).

Другой вариант — dungeon master или [game master](https://en.wikipedia.org/wiki/Gamemaster) — классическая роль в настольных играх.

## Сказка

Вернёмся к добавлению, удалению и перемещению городов в Сказке.

Сейчас нет технических препятствий для появления соответствующего типа записей в [Книге Судеб](https://the-tale.org/game/bills/) (способ влияния на мир игроками). Но есть существенные нетехнические препятствия.

Предпосылки следующие:

- Изменение ландшафта карты изначально является одной из центральных особенностей игры. Оно зависит от расположения объектов на карте, их свойств. В первую очередь — от городов.
- Исторически, Сказка ориентирована на сотрудничество игроков. Игроки и игровой процесс в большей степени ориентированы на созидание своего, чем на разрушение чужого. Это хотелось бы оставить.
- Политическая часть Сказки — медленная игра с почти полной информацией. Игроки не имеют точной информации о ресурсах друг друга, но умеют их оценивать. Вся информация о состоянии карты известна всем игрокам.

Если при текущих механиках разрешить изменять положения городов, то состояние карты быстро схлопнется к «оптимальному» по мнению большинства игроков. Люди договорятся как мир должен выглядеть, чтобы им было удобнее.

На самом деле, карта и так схлопнулась к такому состоянию, но в текущем виде хотя бы иногда способна порождать конфликты интересов. Если же будет разрешено перемещать города, то и эти потенциальные конфликты исчезнут.

Поэтому, прежде чем разрешать перемещение городов, необходимо что-то изменить в ключевых механиках игры.

При этом не подходят:

- Усиление конфликта — игра ориентирован на сотрудничество.
- Сильное ограничение исправления ошибок — мир может застыть.

Остаётся несколько вариантов.

**Вариант первый.** Добавить механики, провоцирующие ошибки игроков в политической части игры. Учитывая размеренность игры и почти полную доступность информации о состоянии мира, это мало реалистично. По крайней мере я не вижу хорошего решения.

**Вариант второй.** Добавить на карту новые типы сущностей, которые влияют на неё с той же силой, что и города, или даже сильнее. При этом сущности должны быть динамическими и независимыми, как минимум частично, от игроков. Иначе игровая ситуация всё равно схлопнется к договорняку.

Попытка усложнить карту была — вводились уникальные свойства клеток, влияющие на стоимость обслуживания объектов на них. В таком виде идея провалилась. Поэтому нужны именно единичные крупные сущности, схожие по свойствам с городами.

Для управления такими сущностями потребуется уже упомянутый AI Director, проектирование которого для многопользовательской игры с перманентным миром выглядит нетривиальной задачей. Особенно в плане «справедливости» его действий хотя бы для большинства игроков.

На текущий момент возможно несколько реализаций механик с AI Director, более-менее совпадающих с планами развития игры.

**Усложнение экономики игры**. Добавление месторождений ресурсов, которые будут заметно влиять на экономику городов. Если сделать месторождения истощаемыми и периодически создавать новые источники ресурсов, то игроки будут вынуждены перестраивать карту и бороться за вкусные участки. Но этот подход способен породить много токсичности из-за «случайности» распределения ресурсов.

**Введение NPC гильдий и эмиссаров**. Такие гильдии могли бы обладать собственной, уникальной, логикой принятия решений на основе мета-целей. Например, захвата мира, максимального развития единственного подконтрольного города, разрушения/создания объектов.

NPC гильдии могли бы нарушать планы игроков по развитию городов, заставляя тех пересматривать стратегию. Этот вариант выглядит интереснее, но для обеспечения его работоспособности необходимо чинить многие механики игры. Иначе игроки «хакнут» логику гильдий и нивелируют их эффект.

Оба варианта выглядят сложными в реализации. Поэтому постоянно откладываются.
