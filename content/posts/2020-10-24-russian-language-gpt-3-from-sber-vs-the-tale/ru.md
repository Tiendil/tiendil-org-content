---
title = "Русскоязычная GPT-2+ от Сбера vs «Сказка»"
tags = [ "the-tale", "open-source", "gamedev", "neural-networks", "practice", "procedural-content-generation",]
published_at = "2020-10-24T12:00:00+00:00"
seo_description = "Эксперименты с генерацией текста для моей игрушки на основе GPT-2 от Сбера."
seo_image = ""
---

[Сбер выпусти свой генератор текста, основанный на GPT-2](https://habr.com/ru/company/sberbank/blog/524522/). Я попробовал скормить ему [сказочные](https://the-tale.org/) описания действий героев. Проверял на [jupiter note](https://colab.research.google.com/github/sberbank-ai/ru-gpts/blob/master/examples/ruGPT3_generation_example.ipynb), опубликованной в вебе, так что вы тоже можете с ней поиграть.

**Обновлено:** говорят, использовали на GPT-3, а GPT-2 с доработками.

Получилось средненько — не на тех текстах всё-таки нейронка обучалась. Вот если бы ей фэнтези скормили… Текст получается осмысленный, но чувствуется явная нехватка контекста.

Самые интересные примеры под катом.

<!-- more -->

Текст из Сказки идёт обычным шрифтом. _Продолжение от Сбера — курсивом._

Тексты от нейронки иногда обрываются. Не знаю, особенность ли это работы сети или конкретной jupiter note.

* * *

Разглядев впереди притаившегося разбойника, решил избежать боя и прокрасться мимо. Вышло очень удачно: уже оставив врага за спиной, нашёл на земле кошель, а в нём 18 монет.

_В кошельке оказалось 6 монет. На них я и отправился на встречу к своей цели. Добраться к дому оказалось не так просто: сначала пришлось преодолеть крутой спуск, а затем ещё и подняться на холм. На холме я увидел дом. Он стоял на отшибе, и, подойдя к нему поближе, увидел, что он окружён стеной, а в ней есть бойницы. В стене были сделаны бойницы для стрельбы в нападающих. В доме, судя по всему, жили слуги._

* * *

Пожаловался Осолу, что не могу найти работу в Оркостане. Осол посоветовал отправиться в Штиль, где у его друга Кабул возникли какие-то проблемы.

_— В Штиль?
— Ну да. Я там уже несколько лет не был.
— А почему именно туда?
— Не знаю. Но, по слухам, там есть неплохие перспективы. Я, собственно, и сам собирался туда.
— А ты уверен, что тебе там понравится?
— Ну, я там никогда раньше не был, — сказал Осол.
— И все же тебе лучш…_

* * *

«Отдых — это святая часть путешествия, которой нельзя пренебрегать. Надо найти место для привала, перевести дух, сменить перевязки».

_— Что это вы тут делаете?
— Проверяю, насколько хорошо я перевязал рану, — ответил я.
— А-а-а, — протянул он, — значит, вы все-таки ранены? — спросил он, заметив мою повязку.
— Да.
— А я думал, вы только что вышли из боя.
— Так и есть, — кивнул я._

* * *

Огненная даппи быстро прицелилась, изготовилась и в стремительном рывке обрушила разящий удар на Халлра.

_Тот от неожиданности и испуга выронил оружие, но не успел даже вскрикнуть. Огненный клинок, словно молния, метнулся к горлу Халлра и вонзился ему прямо под ключицу. Халлр рухнул как подкошенный и замер.
– Вот так, – удовлетворенно произнесла Огненная даппи.
– Я… Я… Я… – лепетал Халлр, не сводя глаз с Огненной даппи. – Я… Я_…

* * *

Халлр выполняет ложный замах мечом, обманывая джинна, и тут же наносит удар с другой стороны.

_Но тот не отступает и, как только лезвие клинка достигает цели, он выпускает из рук свой посох и начинает вращение вокруг своей оси. В результате этого он становится невидимым для Хэллр, а его меч, как ни странно, не касается клинка. В этот момент джинн начинает атаковать его, но Хеллр уклоняется, и удар попадает в цель. Хеллр падает и больше не может атаковать, а джинн, воспользовавшись этим, пытается снова ударит_…

* * *

Сильная магическая волна внезапно ударила в спину, едва не повалив Халлра наземь. Тот обернулся назад и узрел образовавшийся на дороге портал, из которого вышел довольный волшебник.

_— Вот и славно, — сказал он. — Теперь мы можем отправляться в путь.
—А как же вы? — спросил Халлр, с трудом удержавшись от желания броситься к нему, но вместо этого он просто кивнул в ответ.
—Я пойду с вами, — ответил чародей, — а вы пока отдохните.
—Хорошо, — согласился Халлр и устало опустился на землю.
—Я буду рядом, — пообещал волшебник…_
